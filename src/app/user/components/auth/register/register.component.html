<ng-template appPlaceholder></ng-template>

<section class="container">
  <a [routerLink]="['/']" class="text-center d-block mb-4"
    ><img
      class="mw-100"
      src="../../../../../assets/images/pp-logo.jpg"
      alt=""
    />
  </a>
  <div class="alert alert-danger col-md-6 offset-md-3" *ngIf="error">
    <p>{{ error }}</p>
  </div>
  <div class="alert alert-success col-md-6 offset-md-3" *ngIf="isSuccess">
    <p>Registerd Successfully</p>
  </div>

  <div *ngIf="isLoading" class="text-center">
    <app-loader></app-loader>
  </div>
  <form
    [formGroup]="registerForm"
    (ngSubmit)="onSubmit()"
    class="form-card d-flex flex-column align-items-center px-lg-5"
    *ngIf="!isLoading"
  >
    <h2 class="text-center mb-4">Create an account</h2>

    <div class="row">
      <!--first name col-->
      <div class="col-lg-6">
        <mat-form-field appearance="standard">
          <mat-label>First Name</mat-label>
          <input
            type="text"
            matInput
            placeholder="Your First name"
            formControlName="firstName"
          />
          <mat-icon matSuffix>perm_identity</mat-icon>
          <mat-error *ngIf="f.firstName.errors?.required"
            >Firstname must not be empty</mat-error
          >
        </mat-form-field>
      </div>
      <!--first name col-->
      <div class="col-lg-6">
        <mat-form-field appearance="standard">
          <mat-label>Last Name</mat-label>
          <input
            type="text"
            matInput
            placeholder="Your Last name"
            formControlName="lastName"
          />
          <mat-icon matSuffix>perm_identity</mat-icon>
          <mat-error *ngIf="f.lastName.errors?.required"
            >Lastname must not be empty</mat-error
          >
        </mat-form-field>
      </div>
      <!--Date of Birth-->
      <div class="col-lg-6">
        <mat-form-field appearance="standard">
          <mat-label>Date of Birth</mat-label>
          <input
            matInput
            [matDatepicker]="picker"
            formControlName="dob"
            [max]="maxDate"
            [min]="minDate"
            readonly
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="picker"
          ></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
      </div>
      <!--mobile col-->
      <div class="col-lg-6">
        <mat-form-field appearance="standard">
          <mat-label>Mobile Number</mat-label>
          <input
            type="number"
            matInput
            placeholder="Your Mobile Number"
            formControlName="phoneNumber"
          />
          <mat-icon matSuffix>settings_phone</mat-icon>
          <mat-error *ngIf="f.phoneNumber.errors?.required"
            >Mobile number is required</mat-error
          >
          <mat-error *ngIf="f.phoneNumber.errors?.pattern"
            >Mobile number should have 10 digits</mat-error
          >
        </mat-form-field>
      </div>
      <!--emial col-->
      <div class="col-lg-6">
        <mat-form-field appearance="standard">
          <mat-label>Email</mat-label>
          <input
            type="text"
            matInput
            placeholder="Your Email"
            formControlName="email"
          />
          <mat-icon matSuffix>mail </mat-icon>

          <mat-error *ngIf="f.email.errors?.required"
            >Email is required</mat-error
          >
          <mat-error *ngIf="f.email.errors?.email">Email is invalid</mat-error>
        </mat-form-field>
      </div>
      <!--role number-->
      <div class="col-lg-6">
        <mat-form-field appearance="standard">
          <mat-label>Role</mat-label>
          <mat-select formControlName="role">
            <mat-option *ngFor="let user of roles" [value]="user">
              {{ user }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="col-lg-12" *ngIf="f.role.value == 'Physician'">
        <mat-form-field appearance="standard">
          <mat-label>Profile</mat-label>
          <mat-select formControlName="profile">
            <mat-option *ngFor="let profile of profiles" [value]="profile">
              {{ profile }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="col-lg-12">
        <mat-form-field
          appearance="standard"
          hintLabel="Should be atleast 6 characters long"
        >
          <mat-label>Password</mat-label>
          <input
            [type]="hide ? 'password' : 'text'"
            matInput
            placeholder="Your Password"
            formControlName="password"
          />
          <button
            class="px-0"
            mat-icon-button
            matSuffix
            (click)="hide = !hide"
            [attr.aria-label]="'Hide password'"
            [attr.aria-pressed]="hide"
          >
            <mat-icon>{{ hide ? "visibility_off" : "visibility" }}</mat-icon>
          </button>
          <mat-hint align="end">{{ f.password.value?.length }}/6</mat-hint>
          <mat-error *ngIf="f.password.errors?.required"
            >Password is required</mat-error
          >
          <mat-error *ngIf="f.password.errors?.minLength"
            >Has to be 6 characters long</mat-error
          >
        </mat-form-field>
      </div>
      <div class="col-lg-12">
        <mat-form-field appearance="standard">
          <mat-label>Confirm Password</mat-label>
          <input
            type="password"
            matInput
            placeholder="Retype Password"
            formControlName="confirmPassword"
          />
          <mat-error *ngIf="f.confirmPassword.errors?.required"
            >Confirm Password is required</mat-error
          >
          <mat-error *ngIf="f.confirmPassword.errors?.confirmPasswordValidator"
            >Passsword and Confirm Password didn't match.
          </mat-error>
        </mat-form-field>
      </div>
    </div>
    <button
      class="my-4"
      type="submit"
      mat-raised-button
      color="primary"
      [disabled]="registerForm.invalid"
    >
      Register
    </button>
    <p>
      Already an account?
      <a routerLink="/user/login"> Login here </a>
    </p>
  </form>
</section>
